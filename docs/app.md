<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

## functions/cache

Cache files to ensure endpoint isn’t slowed down by excessive requests to
third-party APIs.

## functions/cache

Gets a publication’s configuration

Returns **[Object][1]** Configuration options

## fetchCache

Reads file from cache, fetching remote version if not found

### Parameters

-   `remotePath` **Strong** Path to file on remote store
-   `cachePath` **Strong** Path to file in local cache

Returns **[Object][1]** Fetched file

## readCache

Reads data from cache file

### Parameters

-   `filePath` **Strong** Path to cache file

Returns **[Object][1]** Cache object

## writeCache

Writes data to cache file

### Parameters

-   `filePath` **[Object][1]** Location to save cache file
-   `fileData` **[Object][1]** Cache object

## clearCache

Cleares the cache directory

### Parameters

-   `cacheDir` **[Object][1]** Location to save cache directory

## functions/github

Get, create and delete data at a specified path at configured GitHub repo.

## getContents

-   **See: [GitHub REST API v3: Get Contents][2]**

Gets the contents of a file or directory in a repository

### Parameters

-   `path` **[String][3]** Path to file

Returns **[String][3]** GitHub HTTP response

## createFile

-   **See: [GitHub REST API v3: Create a file][4]**

Creates a new file in a GitHub repository

### Parameters

-   `path` **[String][3]** Path to file
-   `content` **[String][3]** File content
-   `postType` **[String][3]** Microformats post type

Returns **[String][3]** GitHub HTTP response

## deleteFile

-   **See: [GitHub REST API v3: Delete a file][5]**

Deletes a new file in a GitHub repository

### Parameters

-   `path` **[String][3]** Path to file
-   `content` **[String][3]** File content
-   `postType` **[String][3]** Microformats post type

Returns **[String][3]** GitHub HTTP response

## createHistory

Creates empty history file

## readHistory

Reads content of the history file

Returns **[Object][1]** Configuration options

## updateHistory

Updates content of the history file by appending new entry

### Parameters

-   `action` **[String][3]** Entry type
-   `data` **[Object][1]** Entry data

## functions/indieauth

Use [IndieAuth][6] to ensure only
authenticated users can use endpoint to post to configured destination.

## getAuthResponse

Gets authorization response from IndieAuth token endpoint

### Parameters

-   `accessToken` **[String][3]** Access token

Returns **[Promise][7]** Fetch request to IndieAuth token endpoint

## verifyToken

Verifies that token provides permission to post to configured destination

### Parameters

-   `accessToken` **[String][3]** Access token
-   `url` **[String][3]** Destination URL

Returns **[Object][1]** Endpoint response

## functions/microformats

Parse microformats2 objects and determine their properties and type.

## getType

Discover the post type from a mf2 json object.

### Parameters

-   `post`  
-   `mf2` **[object][1]** A mf2 json object

Returns **[String][3]** Type of post

## getProperties

Parses microformats on HTML page.

### Parameters

-   `html` **[String][3]** HTML marked up with microformats

Returns **[Object][1]** mf2

## functions/micropub

Accept form-encoded and JSON data, convert it to a microformats2 object
and process the resulting data so that it can be published to a destination.

## convertFormEncodedToMf2

Converts form-encoded body to microformats2 object. Adapted from
[node-micropub-express][8]
by [Pelle Wessman][9]

### Parameters

-   `body` **[String][3]** Form-encoded body

Returns **[Object][1]** mf2 microformats2 object

**Meta**

-   **copyright**: (c) 2016, Pelle Wessman


## getSlug

Returns a slugified string based on microformats2 object

### Parameters

-   `mf2` **[Object][1]** microformats2 object
-   `separator` **[String][3]** Slug separator

Returns **[Array][10]** Slug

## getDate

Returns an ISO formatted date

### Parameters

-   `mf2` **[Object][1]** microformats2 object

Returns **[Array][10]** ISO formatted date

## getPhotos

Returns an array of photo objects

### Parameters

-   `property` **[Array][10]** microformats2 `photo` property

Returns **[Array][10]** Photos

## getContent

Returns content (HTML, else object value, else property value)

### Parameters

-   `property` **[Array][10]** microformats2 `contents` property

Returns **[Array][10]** Content

## errorResponse

Returns an object containing error information

### Parameters

-   `id` **[String][3]** Identifier
-   `desc` **[String][3]** Description

Returns **[Object][1]** Error object

## successResponse

Returns an object containing success information

### Parameters

-   `id` **[String][3]** Identifier
-   `location` **[String][3]** Location of post

Returns **[Object][1]** Success object

## queryResponse

Returns an object containing information about this application

### Parameters

-   `query` **[String][3]** Identifier
-   `pubConfig` **[Object][1]** Publication configuration
-   `appUrl` **[String][3]** URL of application

Returns **[Object][1]** Query object

## createPost

Creates a post

### Parameters

-   `mf2` **[String][3]** microformats2 object
-   `pubConfig` **[Object][1]** Publication configuration

Returns **[String][3]** Location of created post

## getPost

Gets post to inspect its properties

### Parameters

-   `url` **[String][3]** URL path to post

Returns **[Object][1]** mf2

## updatePost

Updates a post

### Parameters

-   `url` **[String][3]** URL path to post
-   `content` **[String][3]** Content to update

Returns **[Object][1]** Response

## deletePost

Deletes a post

### Parameters

-   `url` **[String][3]** URL of published post

Returns **[Object][1]** Response

## functions/render

Render a template or string using context data using Nunjucks.

## string

Renders a template string using context data

### Parameters

-   `string` **[String][3]** Template string
-   `context` **[String][3]** Context data

Returns **[String][3]** Rendered string

## template

Renders a template using context data

### Parameters

-   `templatePath` **[String][3]** Path to template file
-   `context` **[String][3]** Context data

Returns **[String][3]** Rendered string

## functions/utils

Common utility functions.

## decodeFormEncodedString

Decodes form-encoded string

### Parameters

-   `string` **[String][3]** String to decode

### Examples

```javascript
decodeFormEncodedString('foo+bar') => 'foo bar'
```

```javascript
decodeFormEncodedString('http%3A%2F%2Ffoo.bar') => 'http://foo.bar'
```

Returns **[String][3]** Decoded string

## removeEmptyObjectKeys

Removes empty keys from an object

### Parameters

-   `object` **[Object][1]** Object with empty strings

Returns **[Object][1]** Sanitized object

## normalizePath

Removes / from beginning and end of strings, useful for constructing paths

### Parameters

-   `string` **[Object][1]** String

### Examples

```javascript
normalizePath('/foo/bar/') => 'foo/bar'
```

Returns **[Object][1]** Normalized object

## sanitizeHtml

Removes newlines, carriage returns, tabs and successive spaces from HTML string

### Parameters

-   `string` **[String][3]** String

Returns **[String][3]** Sanitized HTML

## routes/micropub

### get

Responds to GET requests

#### Parameters

-   `request` **[Object][1]** Request
-   `response` **[Object][1]** Response

Returns **[Object][1]** HTTP response

### post

Responds to POST requests

#### Parameters

-   `request` **[Object][1]** Request
-   `response` **[Object][1]** Response
-   `next` **[Object][1]** Callback

Returns **[Object][1]** HTTP response

[1]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[2]: https://developer.github.com/v3/repos/contents/#get-contents

[3]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[4]: https://developer.github.com/v3/repos/contents/#create-a-file

[5]: https://developer.github.com/v3/repos/contents/#delete-a-file

[6]: https://www.w3.org/TR/indieauth/

[7]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[8]: https://github.com/voxpelli/node-micropub-express

[9]: https://kodfabrik.se

[10]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array
