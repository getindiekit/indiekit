<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

## cache

Caches files to prevent application from making excessive requests to APIs

### update

Creates a new file in the cache, populating with content from remote source

#### Parameters

-   `filePath` **[Object][1]** Location to cache file
-   `fileData` **[Object][1]** Cache object to create

### delete

Deletes the cache directory

#### Parameters

-   `cacheDir` **[Object][1]** Location to save cache directory

### read

Reads a file in the cache, fetching remote version if not found

#### Parameters

-   `remotePath` **[String][2]** Path to file on remote store
-   `cachePath` **[String][2]** Path to file in local cache

Returns **([Promise][3] \| [Object][1])** Fetched file object

## github

Get, create and delete data at a specified path at configured GitHub repo.

## getContents

-   **See: [GitHub REST API v3: Get Contents][4]**

Reads content of a file or directory in a repository

### Parameters

-   `path` **[String][2]** Path to file

Returns **[Promise][3]** GitHub HTTP response

## createFile

-   **See: [GitHub REST API v3: Create a file][5]**

Creates a new file in a GitHub repository

### Parameters

-   `path` **[String][2]** Path to file
-   `content` **[String][2]** File content
-   `options` **[String][2]** Options

Returns **[Promise][3]** GitHub HTTP response

## updateFile

-   **See: [GitHub REST API v3: Update a file][6]**

Updates a file in a GitHub repository

### Parameters

-   `path` **[String][2]** Path to file
-   `content` **[String][2]** File content
-   `options` **[String][2]** Options

Returns **[Promise][3]** GitHub HTTP response

## deleteFile

-   **See: [GitHub REST API v3: Delete a file][7]**

Deletes a file in a GitHub repository

### Parameters

-   `path` **[String][2]** Path to file
-   `options` **[String][2]** Options

Returns **[Promise][3]** GitHub HTTP response

## history

Creates log of Micropub actions taken

### create

Creates an empty history file

### read

Reads contents of the history file

Returns **[Object][1]** Configuration options

### update

Updates contents of history file by appending new entry

#### Parameters

-   `action` **[String][2]** Entry type
-   `data` **[Object][1]** Entry data

## indieauth

Use [IndieAuth][8] to ensure only
authenticated users can use endpoint for posting to configured destination.

### request

Authenticates an access token with IndieAuth token endpoint

#### Parameters

-   `accessToken` **[String][2]** Access token

Returns **[Promise][3]** Token endpoint reponse object

### verifyToken

Verifies that a token provides permissions to post to configured publication

#### Parameters

-   `accessToken` **[String][2]** Access token
-   `url` **[String][2]** Publication URL

Returns **[Promise][3]** Token endpoint reponse object

## microformats

Discover, parse and transform microformats2 objects

### deriveData

Generates post data by merging submitted and derived information about a post

#### Parameters

-   `pubConfig` **[Object][1]** Publication configuration
-   `mf2` **[String][2]** microformats2 object
-   `files` **[String][2]** File attachments

Returns **[Promise][3]** mf2 object

### formEncodedToMf2

Parses microformats in a form-encoded POST request.
Adapted from [node-micropub-express][9]
by [Pelle Wessman][10]

#### Parameters

-   `body` **[String][2]** Form-encoded body

Returns **[Object][1]** mf2 object

**Meta**

-   **copyright**: (c) 2016, Pelle Wessman


### htmlToMf2

Parses microformats on HTML page

#### Parameters

-   `html` **[String][2]** HTML marked up with microformats
-   `properties` **[String][2]** mf2 properties to return

Returns **[Promise][3]** mf2 object

### postType

Discover the post type from a mf2 json object.

#### Parameters

-   `post` **[object][1]** A mf2 json object

Returns **[String][2]** Type of post

### urlToMf2

Parses microformats at a given URL

#### Parameters

-   `url` **[String][2]** URL path to post
-   `properties` **[String][2]** mf2 properties to return

Returns **[Promise][3]** mf2 object

## files

-   **See: [https://stackoverflow.com/a/37576787/11107625][11]**

Turns out async/await doesn’t work so great with forEach loops. Use
asynchronous `await Promise.all(files.map(async file => {…}))` or
synchronous `for (const file of files) {…}` instead.
(Asynchronous pattern trips up Micropub.rocks! validator)

## micropub

Process and transform microformats in request so that it can be published to
a destination.

### update

Creates a new post

#### Parameters

-   `pubConfig` **[Object][1]** Publication configuration
-   `body` **[String][2]** Body content (contains microformats2 object)
-   `files` **[String][2]** File attachments

Returns **[String][2]** Location of created post

### update

Updates a post

#### Parameters

-   `url` **[String][2]** URL path to post
-   `content` **[String][2]** Content to update

Returns **[Object][1]** Response

### delete

Deletes a post

#### Parameters

-   `url` **[String][2]** URL of published post

Returns **[Promise][3]** Response object

### response

Sends HTTP response with error/success information encoded as JSON

## micropub

Returns an object containing information about this application

### Parameters

-   `query` **[String][2]** Identifier
-   `pubConfig` **[Object][1]** Publication configuration
-   `appUrl` **[String][2]** URL of application

Returns **[Promise][3]** Query object

### update

Creates a new post

#### Parameters

-   `pubConfig` **[Object][1]** Publication configuration
-   `body` **[String][2]** Body content (contains microformats2 object)
-   `files` **[String][2]** File attachments

Returns **[String][2]** Location of created post

### update

Updates a post

#### Parameters

-   `url` **[String][2]** URL path to post
-   `content` **[String][2]** Content to update

Returns **[Object][1]** Response

### delete

Deletes a post

#### Parameters

-   `url` **[String][2]** URL of published post

Returns **[Promise][3]** Response object

### response

Sends HTTP response with error/success information encoded as JSON

## error

Returns an object containing error information

### Parameters

-   `id` **[String][2]** Identifier
-   `desc` **[String][2]** Description

Returns **[Object][1]** Error object

## success

Returns an object containing success information

### Parameters

-   `id` **[String][2]** Identifier
-   `location` **[String][2]** Location of post

Returns **[Object][1]** Success object

## publication

Gets a publication’s configuration

Returns **[Promise][3]** Configuration object

## render

-   **See: [Nunjucks API: renderString][12]**

Render a Nunjucks template string using context data

### Parameters

-   `string` **[String][2]** Template string
-   `context` **[String][2]** Context data

Returns **[String][2]** Rendered string

## utils

Common utility functions.

## capitalizeFirstLetter

Capitalizes first letter of a string

### Parameters

-   `string` **[String][2]** String to capitalize

### Examples

```javascript
capitalizeFirstLetter('foo bar') => 'Foo bar'
```

Returns **[String][2]** Capitalized string

## decodeFormEncodedString

Decodes form-encoded string

### Parameters

-   `string` **[String][2]** String to decode

### Examples

```javascript
decodeFormEncodedString('foo+bar') => 'foo bar'
```

```javascript
decodeFormEncodedString('http%3A%2F%2Ffoo.bar') => 'http://foo.bar'
```

Returns **[String][2]** Decoded string

## removeEmptyObjectKeys

Removes empty keys from an object

### Parameters

-   `object` **[Object][1]** Object with empty strings

### Examples

```javascript
removeEmptyObjectKeys({
  foo: 'bar',
  baz: {
    qux: {
      quux: ''
    }
  }
}) => '{foo: bar}'
```

Returns **[Object][1]** Sanitized object

## normalizePath

Removes ‘/’ from beginning and end of string. Useful for constructing paths

### Parameters

-   `string` **[Object][1]** String

### Examples

```javascript
normalizePath('/foo/bar/') => 'foo/bar'
```

Returns **[Object][1]** Normalized object

## sanitizeHtml

Removes newlines, carriage returns, tabs and successive spaces from HTML string

### Parameters

-   `string` **[String][2]** String

Returns **[String][2]** Sanitized HTML

## routes/micropub

### get

Responds to GET requests

#### Parameters

-   `request` **[Object][1]** Request
-   `response` **[Object][1]** Response

Returns **[Object][1]** HTTP response

### post

Responds to POST requests

#### Parameters

-   `request` **[Object][1]** Request
-   `response` **[Object][1]** Response
-   `next` **[Object][1]** Callback

Returns **[Object][1]** HTTP response

[1]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[2]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[3]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[4]: https://developer.github.com/v3/repos/contents/#get-contents

[5]: https://developer.github.com/v3/repos/contents/#create-a-file

[6]: https://developer.github.com/v3/repos/contents/#update-a-file

[7]: https://developer.github.com/v3/repos/contents/#delete-a-file

[8]: https://www.w3.org/TR/indieauth/

[9]: https://github.com/voxpelli/node-micropub-express

[10]: https://kodfabrik.se

[11]: https://stackoverflow.com/a/37576787/11107625

[12]: https://mozilla.github.io/nunjucks/api.html#renderstring
