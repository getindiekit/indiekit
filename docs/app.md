<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [cache][1]
    -   [update][2]
        -   [Parameters][3]
    -   [delete][4]
        -   [Parameters][5]
    -   [read][6]
        -   [Parameters][7]
-   [indieauth][8]
    -   [request][9]
        -   [Parameters][10]
    -   [verifyToken][11]
        -   [Parameters][12]
-   [memos][13]
    -   [create][14]
    -   [read][15]
    -   [update][16]
        -   [Parameters][17]
-   [microformats][18]
    -   [derviveContent][19]
        -   [Parameters][20]
    -   [derivePhotoProperty][21]
        -   [Parameters][22]
    -   [dervivePublishedProperty][23]
        -   [Parameters][24]
    -   [derviveSlug][25]
        -   [Parameters][26]
    -   [formEncodedToMf2][27]
        -   [Parameters][28]
    -   [htmlToMf2][29]
        -   [Parameters][30]
    -   [urlToMf2][31]
        -   [Parameters][32]
-   [micropub][33]
    -   [createMedia][34]
        -   [Parameters][35]
    -   [createPost][36]
        -   [Parameters][37]
    -   [deletePost][38]
        -   [Parameters][39]
    -   [error][40]
        -   [Parameters][41]
    -   [query][42]
        -   [Parameters][43]
    -   [response][44]
        -   [Parameters][45]
    -   [updatePost][46]
        -   [Parameters][47]
-   [publication][48]
-   [render][49]
    -   [Parameters][50]
-   [store/github][51]
    -   [getContents][52]
        -   [Parameters][53]
    -   [createFile][54]
        -   [Parameters][55]
    -   [updateFile][56]
        -   [Parameters][57]
    -   [deleteFile][58]
        -   [Parameters][59]
-   [store][60]
-   [utils][61]
    -   [createRandomString][62]
        -   [Examples][63]
    -   [deriveFileProperties][64]
        -   [Parameters][65]
        -   [Examples][66]
    -   [deriveMediaType][67]
        -   [Parameters][68]
        -   [Examples][69]
    -   [decodeFormEncodedString][70]
        -   [Parameters][71]
        -   [Examples][72]
    -   [excerptString][73]
        -   [Parameters][74]
        -   [Examples][75]
    -   [normalizePath][76]
        -   [Parameters][77]
        -   [Examples][78]
-   [routes][79]
    -   [admin.post][80]
        -   [Parameters][81]
    -   [media.post][82]
        -   [Parameters][83]
    -   [micropub.get][84]
        -   [Parameters][85]
    -   [micropub.post][86]
        -   [Parameters][87]

## cache

Caches files to prevent application from making excessive requests to APIs

### update

Creates a new file in the cache, populating it with specified data

#### Parameters

-   `filePath` **[Object][88]** Location to cache file
-   `fileData` **[Object][88]** Data to write to file

### delete

Deletes the cache directory

#### Parameters

-   `dir` **[Object][88]** Location of cache directory

### read

Reads a file in the cache, fetching from store if not found

#### Parameters

-   `storePath` **[String][89]** Path to file in store
-   `cachePath` **[String][89]** Path to file in cache

Returns **([Promise][90] \| [Object][88])** Fetched file object

## indieauth

Use [IndieAuth][91] to ensure only
authenticated users can use endpoint for posting to configured destination.

### request

Authenticates an access token with IndieAuth token endpoint

#### Parameters

-   `accessToken` **[String][89]** Access token
-   `endpoint` **[String][89]** IndieAuth token endpoint URL

Returns **[Promise][90]** Token endpoint reponse object

### verifyToken

Verifies that a token provides permissions to post to configured publication

#### Parameters

-   `accessToken` **[String][89]** Access token
-   `url` **[String][89]** Publication URL

Returns **[Promise][90]** Token endpoint reponse object

## memos

Records of actions and resulting changes, stored for later retrevial.
(i.e. for update and undelete actions).

### create

Creates memos file

### read

Reads memo

Returns **[Object][88]** Configuration options

### update

Updates memo (either by updating existing, or appending new)

#### Parameters

-   `action` **[String][89]** Entry type
-   `data` **[Object][88]** Entry data

## microformats

Discover, parse and transform microformats2 objects

### derviveContent

Derives content (HTML, else object value, else property value)

#### Parameters

-   `mf2` **[Object][88]** microformats2 object

Returns **[Array][92]** Content

### derivePhotoProperty

Combines referenced and attached photos into one object which can be used in
a microformats2 object. Attached photos are uploaded to GitHub.

#### Parameters

-   `mf2` **[Object][88]** microformats2 object
-   `files` **[String][89]** Photos attached as multipart data
-   `typeConfig` **[Object][88]** Post type configuration

Returns **[Promise][90]** Array of photo obejcts

### dervivePublishedProperty

Derives published date (based on microformats2 data, else the current date)

#### Parameters

-   `mf2` **[Object][88]** microformats2 object

Returns **[Array][92]** Array containing ISO formatted date

### derviveSlug

Derives slug (using `mp-slug` value, slugified name else a random number)

#### Parameters

-   `mf2` **[Object][88]** microformats2 object
-   `separator` **[String][89]** Slug separator

Returns **[Array][92]** Array containing slug value

### formEncodedToMf2

Parses microformats in form-encoded POST request.
Adapted from [node-micropub-express][93]
by [Pelle Wessman][94]

#### Parameters

-   `body` **[String][89]** Form-encoded body

Returns **[Object][88]** mf2 object

**Meta**

-   **copyright**: (c) 2016, Pelle Wessman


### htmlToMf2

Parses microformats on HTML page

#### Parameters

-   `html` **[String][89]** HTML marked up with microformats
-   `properties` **[String][89]** mf2 properties to return

Returns **[Promise][90]** mf2 object

### urlToMf2

Parses microformats at a given URL

#### Parameters

-   `url` **[String][89]** URL path to post
-   `properties` **[String][89]** mf2 properties to return

Returns **[Promise][90]** mf2 object

## micropub

Process and transform microformats in request so that it can be published to
a destination.

### createMedia

Creates a new post

#### Parameters

-   `pub` **[Object][88]** Publication configuration
-   `files` **[String][89]** File attachments

Returns **[String][89]** Location of created post

### createPost

Creates a new post

#### Parameters

-   `pub` **[Object][88]** Publication configuration
-   `body` **[String][89]** Body content (contains microformats2 object)
-   `files` **[String][89]** File attachments

Returns **[String][89]** Location of created post

### deletePost

Deletes a post

#### Parameters

-   `url` **[String][89]** URL of published post

Returns **[Promise][90]** Response object

### error

Returns error information

#### Parameters

-   `id` **[String][89]** Identifier
-   `desc` **[String][89]** Description

Returns **[Object][88]** Error object

### query

Returns an object containing information about this application

#### Parameters

-   `request` **[String][89]** HTTP request object
-   `pub` **[String][89]** Publication configuration

Returns **[Promise][90]** Query object

### response

Returns success information

#### Parameters

-   `id` **[String][89]** Identifier
-   `location` **[String][89]** Location of post

Returns **[Object][88]** Success object

### updatePost

Updates a post

#### Parameters

-   `url` **[String][89]** URL path to post
-   `content` **[String][89]** Content to update

Returns **[Object][88]** Response

## publication

Gets a publication’s configuration and combines it with default values set by
application.

Returns **[Promise][90]** Configuration object

## render

-   **See: [Nunjucks API: renderString][95]**

Render a Nunjucks template string using context data

### Parameters

-   `string` **[String][89]** Template string
-   `context` **[String][89]** Context data

Returns **[String][89]** Rendered string

## store/github

Get, create and delete data at a specified path at configured GitHub repo.

### getContents

-   **See: [GitHub REST API v3: Get Contents][96]**

Reads content of a file or directory in a repository

#### Parameters

-   `path` **[String][89]** Path to file

Returns **[Promise][90]** GitHub HTTP response

### createFile

-   **See: [GitHub REST API v3: Create a file][97]**

Creates a new file in a GitHub repository

#### Parameters

-   `path` **[String][89]** Path to file
-   `content` **[String][89]** File content
-   `options` **[String][89]** Options

Returns **[Promise][90]** GitHub HTTP response

### updateFile

-   **See: [GitHub REST API v3: Update a file][98]**

Updates a file in a GitHub repository

#### Parameters

-   `path` **[String][89]** Path to file
-   `content` **[String][89]** File content
-   `options` **[String][89]** Options

Returns **[Promise][90]** GitHub HTTP response

### deleteFile

-   **See: [GitHub REST API v3: Delete a file][99]**

Deletes a file in a GitHub repository

#### Parameters

-   `path` **[String][89]** Path to file
-   `options` **[String][89]** Options

Returns **[Promise][90]** GitHub HTTP response

## store

Interfaces to remote locations where files and configuration are stored.

## utils

Common utility functions.

### createRandomString

Generates random alpha-numeric string, 5 characters long

#### Examples

```javascript
createRandomString() => 'b3dog'
```

Returns **[Object][88]** Alpha-numeric string

### deriveFileProperties

Derives additional file name properties

#### Parameters

-   `file` **[Object][88]** Original file object

#### Examples

```javascript
deriveFileProperties('brighton-pier.jpg') => {
  originalname: 'brighton-pier.jpg',
  filedate: '2019-03-03T05:07:09+00:00',
  filename: 'ds48s',
  fileext: '.jpg'
}
```

Returns **[Object][88]** File properties

### deriveMediaType

Derives media type and returns equivalent IndieWeb post type

#### Parameters

-   `mimetype` **[Object][88]** MIME type

#### Examples

```javascript
deriveMediaType('image/jpeg') => 'photo'
```

Returns **[String][89]** Returns either 'photo', 'video' or audio

### decodeFormEncodedString

Decodes form-encoded string

#### Parameters

-   `string` **[String][89]** String to decode

#### Examples

```javascript
decodeFormEncodedString('foo+bar') => 'foo bar'
```

```javascript
decodeFormEncodedString('http%3A%2F%2Ffoo.bar') => 'http://foo.bar'
```

Returns **[String][89]** Decoded string

### excerptString

Gets first n words from a string

#### Parameters

-   `string` **[String][89]** String to excerpt
-   `n` **[Number][100]** Max number of words

#### Examples

```javascript
excerptString('Foo bar baz', 2) => 'Foo bar'
```

Returns **[String][89]** Excerpt

### normalizePath

Removes ‘/’ from beginning and end of string. Useful for constructing paths

#### Parameters

-   `string` **[Object][88]** String

#### Examples

```javascript
normalizePath('/foo/bar/') => 'foo/bar'
```

Returns **[Object][88]** Normalized object

## routes

### admin.post

Responds to POST requests

#### Parameters

-   `request` **[Object][88]** Request
-   `response` **[Object][88]** Response
-   `next` **[Object][88]** Callback

Returns **[Object][88]** HTTP response

### media.post

Responds to Micropub media-endpoint POST requests

#### Parameters

-   `request` **[Object][88]** Request
-   `response` **[Object][88]** Response
-   `next` **[Object][88]** Callback

Returns **[Object][88]** HTTP response

### micropub.get

Responds to Micropub GET requests

#### Parameters

-   `request` **[Object][88]** Request
-   `response` **[Object][88]** Response

Returns **[Object][88]** HTTP response

### micropub.post

Responds to Micropub POST requests

#### Parameters

-   `request` **[Object][88]** Request
-   `response` **[Object][88]** Response
-   `next` **[Object][88]** Callback

Returns **[Object][88]** HTTP response

[1]: #cache

[2]: #update

[3]: #parameters

[4]: #delete

[5]: #parameters-1

[6]: #read

[7]: #parameters-2

[8]: #indieauth

[9]: #request

[10]: #parameters-3

[11]: #verifytoken

[12]: #parameters-4

[13]: #memos

[14]: #create

[15]: #read-1

[16]: #update-1

[17]: #parameters-5

[18]: #microformats

[19]: #dervivecontent

[20]: #parameters-6

[21]: #derivephotoproperty

[22]: #parameters-7

[23]: #dervivepublishedproperty

[24]: #parameters-8

[25]: #derviveslug

[26]: #parameters-9

[27]: #formencodedtomf2

[28]: #parameters-10

[29]: #htmltomf2

[30]: #parameters-11

[31]: #urltomf2

[32]: #parameters-12

[33]: #micropub

[34]: #createmedia

[35]: #parameters-13

[36]: #createpost

[37]: #parameters-14

[38]: #deletepost

[39]: #parameters-15

[40]: #error

[41]: #parameters-16

[42]: #query

[43]: #parameters-17

[44]: #response

[45]: #parameters-18

[46]: #updatepost

[47]: #parameters-19

[48]: #publication

[49]: #render

[50]: #parameters-20

[51]: #storegithub

[52]: #getcontents

[53]: #parameters-21

[54]: #createfile

[55]: #parameters-22

[56]: #updatefile

[57]: #parameters-23

[58]: #deletefile

[59]: #parameters-24

[60]: #store

[61]: #utils

[62]: #createrandomstring

[63]: #examples

[64]: #derivefileproperties

[65]: #parameters-25

[66]: #examples-1

[67]: #derivemediatype

[68]: #parameters-26

[69]: #examples-2

[70]: #decodeformencodedstring

[71]: #parameters-27

[72]: #examples-3

[73]: #excerptstring

[74]: #parameters-28

[75]: #examples-4

[76]: #normalizepath

[77]: #parameters-29

[78]: #examples-5

[79]: #routes

[80]: #adminpost

[81]: #parameters-30

[82]: #mediapost

[83]: #parameters-31

[84]: #micropubget

[85]: #parameters-32

[86]: #micropubpost

[87]: #parameters-33

[88]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[89]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[90]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[91]: https://www.w3.org/TR/indieauth/

[92]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[93]: https://github.com/voxpelli/node-micropub-express

[94]: https://kodfabrik.se

[95]: https://mozilla.github.io/nunjucks/api.html#renderstring

[96]: https://developer.github.com/v3/repos/contents/#get-contents

[97]: https://developer.github.com/v3/repos/contents/#create-a-file

[98]: https://developer.github.com/v3/repos/contents/#update-a-file

[99]: https://developer.github.com/v3/repos/contents/#delete-a-file

[100]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number
