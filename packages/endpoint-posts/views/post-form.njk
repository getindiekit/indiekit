{% extends "form.njk" %}

{% block fieldset %}
  {{ input({
    name: "type",
    value: "event" if postType === "event" else "entry",
    type: "hidden"
  }) | indent(2) }}

  {{ input({
    name: "post-type",
    value: postType,
    type: "hidden"
  }) | indent(2) }}

  {{ input({
    id: "bookmark-of",
    name: "bookmark-of",
    value: errors["bookmark-of"].value or post["bookmark-of"],
    label: {
      text: __("posts.form.bookmark-of.label")
    },
    errorMessage: {
      text: errors["bookmark-of"].msg
    } if errors["bookmark-of"]
  }) if postType === "bookmark" | indent(2) }}

  {{ input({
    id: "name",
    name: "name",
    value: errors.name.value or post.name,
    label: {
      text: __("posts.form.name.label")
    },
    optional: (postType !== "article") and (postType !== "bookmark"),
    errorMessage: {
      text: errors.name.msg
    } if errors.name
  }) if postType !== "note" | indent(2) }}

  {{ textarea({
    id: "content",
    name: "content",
    value: errors.content.value or post.content.text,
    label: {
      text: __("posts.form.content.label")
    },
    optional: (postType !== "article") and (postType !== "note"),
    errorMessage: {
      text: errors.content.msg
    } if errors.content
  }) | indent(2) }}

  {{ checkboxes({
    idPrefix: "mp-syndicate-to",
    name: "mp-syndicate-to",
    fieldset: {
      legend: {
        text: __("posts.form.mp-syndicate-to.label")
      }
    },
    items: syndicationTargetItems
  }) | indent(2) }}

  {% call details({ summary: __("posts.form.advancedOptions") }) %}
    {{ input({
      value: errors.category.value or post.category,
      label: {
        text: __("posts.form.category.label")
      },
      optional: true,
      attributes: {
        "data-controller": "token-input",
        "data-token-input-items-value": publication.categories
      }
    }) | indent(4) }}

    {{ input({
      id: "mp-slug",
      name: "mp-slug",
      value: errors["mp-slug"].value or post["mp-slug"],
      label: {
        text: __("posts.form.mp-slug.label")
      },
      optional: true
    }) | indent(4) }}

    {{ radios({
      classes: "radios--inline",
      idPrefix: "visibility",
      name: "visibility",
      fieldset: {
        legend: {
          text: __("posts.form.visibility.label")
        }
      },
      items: visibilityItems
    }) | indent(4) }}
  {% endcall %}

  <div class="button-group">
    {{ button({
      name: "post-status",
      value: "published",
      text: __("posts.form.update") if postStatus === "published" else __("posts.form.publish")
    }) if not draftMode | indent(4) }}

    {{ button({
      name: "post-status",
      value: "draft",
      classes: "button--secondary",
      text: __("posts.form.updateDraft") if postStatus === "draft" else __("posts.form.publishDraft")
    }) if postStatus !== "published" | indent(4) }}

    {{ prose({
      text: "[" + __("posts.form.cancel") + "](" + back + ")"
    }) | indent(4) }}
  </div>
{% endblock %}